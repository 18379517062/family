<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>后台信息管理系统</title>

    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/font-awesome/css/font-awesome.css}" rel="stylesheet"/>

    <link th:href="@{/css/animate.css}" rel="stylesheet"/>
    <link th:href="@{/css/style.css}" rel="stylesheet"/>

</head>

<body>
<div id="wrapper">
    <nav class="navbar-default navbar-static-side" role="navigation" th:include="nav :: navigation"></nav>
    <div id="page-wrapper" class="gray-bg">
<!--        <div class="border-bottom" th:include="header :: headerTop"></div>-->

        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>搜索&amp;操作</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content" style="display: block;">


                    <form action="/item/searchItem">
                        <div class="row">

                            <div class="col-sm-2 m-b-xs">
                                <i>收支</i>
                                <select id="status" name="status" class="form-control"  onchange="selectState()" >
                                    <option value="-1"> --- 全选 --- </option>
                                    <option value="1" >支出</option>
                                    <option value="0">收入</option>
                                </select>
                            </div>

                            <div class="col-sm-2 m-b-xs">

                                <select name="categoryId" id="categoryId" class="form-control" >
                                    <option value="-1">---全选---</option>
                                </select>
                            </div>

                            <div class="col-sm-2 m-b-xs">
                                <input id="startTime" name="startTime"  class="form-control" type="date"  placeholder="起始时间" />
                            </div>
                            <div class="col-sm-2 m-b-xs">
                                <input id="endTime" name="endTime"  class="form-control" type="date"  placeholder="截止时间"/>
                            </div>
                            <div class="col-sm-2 m-b-xs">
                                <button class="btn btn-primary btn-block" type="submit"><i class="fa fa-search"></i>&nbsp;&nbsp;&nbsp;&nbsp;<strong>搜索</strong></button>
                            </div>
                        </div>
                    </form>



                </div>
            </div>
        </div>


        <div class="wrapper wrapper-content">
            <div class="row">
                <div class="col-lg-3">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <span class="label label-success pull-right">Income</span>
                            <h5>总收入</h5>
                        </div>
                        <div class="ibox-content">
                            <h1 class="no-margins" th:text="11">--月收入啦啦</h1>
                            <!--<h1 class="no-margins" th:text="${stats.mIncome}">&#45;&#45;月收入啦啦</h1>-->
                            <!--<td th:text="${stats.monthlyIncome}">Onions</td>-->

                            <div class="stat-percent font-bold text-success" th:text="22">月收入环比<i
                                    class="fa fa-level-up"></i></div>
                            <small>Monthly income</small>
                            <!--<div class="stat-percent font-bold text-success" th:text="${stats.incomePer}">月收入环比<i-->

                        </div>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <span class="label label-info pull-right">Order</span>
                            <h5>当前月订单数</h5>
                        </div>
                        <div class="ibox-content">

                            <h1 class="no-margins" th:text="33">--月订单数</h1>
                            <!--<h1 class="no-margins" th:text="${stats.mOrderNum}">&#45;&#45;月订单数</h1>-->
                            <!--<div class="stat-percent font-bold text-info" th:text="${stats.orderNumPer}">20% <i-->
                            <div class="stat-percent font-bold text-info" th:text="44">20% <i
                                    class="fa fa-level-up"></i></div>
                            <small>Monthly orders</small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <span class="label label-primary pull-right">Today</span>
                            <h5>访问量</h5>
                        </div>
                        <div class="ibox-content">
                            <h1 class="no-margins" th:text="55">--访问量</h1>
                            <!--<h1 class="no-margins" th:text="${stats.pv}">&#45;&#45;访问量</h1>-->
                            <div class="stat-percent font-bold text-navy">44% <i class="fa fa-level-up"></i></div>
                            <small>New visits</small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <span class="label label-danger pull-right">Refund</span>
                            <h5>当前月退单数</h5>
                        </div>
                        <div class="ibox-content">

                            <h1 class="no-margins" th:text="66">80,600</h1>
                            <!--<h1 class="no-margins" th:text="${stats.mOrderRefund}">80,600</h1>-->
                            <!--<div class="stat-percent font-bold text-danger" th:text="${stats.mOrderRefundPer}">38%</div>-->
                            <div class="stat-percent font-bold text-danger" th:text="77">38%</div>
                            <small>Monthly refund</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <div  class="ibox float-e-margins" >
                        <div  class="ibox float-e-margins">
                            <div id="main" class="ibox float-e-margins" style="width: 600px;height:400px;"></div>

                            <!-- <div class="ibox-title">-->
<!--                            <h5>Orders</h5>-->
<!--                            <div class="pull-right">-->
<!--                                <div class="btn-group">-->
<!--                                    <button type="button" class="btn btn-xs btn-white active">Today</button>-->
<!--                                    <button type="button" class="btn btn-xs btn-white">Monthly</button>-->
<!--                                    <button type="button" class="btn btn-xs btn-white">Annual</button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="ibox-content">-->
<!--                            <div class="row">-->
<!--                                <div class="col-lg-9">-->
<!--                                    <div class="flot-chart">-->
<!--                                        <div class="flot-chart-content" id="flot-dashboard-chart"></div>-->
<!--                                        <input type="hidden" id="data2" th:value="data3"/>-->
<!--                                        <input type="hidden" id="data3" th:value="data3"/>-->
<!--                                        &lt;!&ndash;<input type="hidden" id="data2" th:value="${data2}"/>&ndash;&gt;-->
<!--                                        &lt;!&ndash;<input type="hidden" id="data3" th:value="${data3}"/>&ndash;&gt;-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="col-lg-3">-->
<!--                                    <ul class="stat-list">-->
<!--                                        <li>-->
<!--                                            <h2 class="no-margins">2,346</h2>-->
<!--                                            <small>Total orders in period</small>-->
<!--                                            <div class="stat-percent">48% <i class="fa fa-level-up text-navy"></i></div>-->
<!--                                            <div class="progress progress-mini">-->
<!--                                                <div style="width: 48%;" class="progress-bar"></div>-->
<!--                                            </div>-->
<!--                                        </li>-->
<!--                                        <li>-->
<!--                                            <h2 class="no-margins ">4,422</h2>-->
<!--                                            <small>Orders in last month</small>-->
<!--                                            <div class="stat-percent">60% <i class="fa fa-level-down text-navy"></i>-->
<!--                                            </div>-->
<!--                                            <div class="progress progress-mini">-->
<!--                                                <div style="width: 60%;" class="progress-bar"></div>-->
<!--                                            </div>-->
<!--                                        </li>-->
<!--                                        <li>-->
<!--                                            <h2 class="no-margins ">9,180</h2>-->
<!--                                            <small>Monthly income from orders</small>-->
<!--                                            <div class="stat-percent">22% <i class="fa fa-bolt text-navy"></i></div>-->
<!--                                            <div class="progress progress-mini">-->
<!--                                                <div style="width: 22%;" class="progress-bar"></div>-->
<!--                                            </div>-->
<!--                                        </li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer" th:include="footer :: copyright"></div>
    </div>
</div>

<!-- Mainly scripts -->
<script th:src="@{/js/jquery-2.1.1.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/echarts/4.6.0/echarts.min.js"></script>




<script>
    var myChart = echarts.init(document.getElementById('main'));

    var xData = [1,2,3,4,5,6,7,8,9,10,11,12];
    var yData = [];
    var map = new Map();
    for(var i=0;i<12;i++){  //月份：数值
        map.set(i,0.0);
    }

    //AJAX接收数据主体
    $.ajax({
        type:"GET",
        url:"/income",
        dataType:"json",
        async:false,
        success:function (result) {

            for (var i = 0; i < result.length; i++){
                var d = new Date(result[i].createTime);  //传过来的是string类型
                var m = d.getMonth();
                var v = map.get(m)+(result[i].money);
                map.set(m,v);  //将同月份的数值加到一起
            }
        },
        error :function(errorMsg) {
            alert("获取后台数据失败！");
        }
    });
    for (var i = 0; i <= map.size; i++) {
        yData.push(map.get(i));
    }



    var option = {
        title : {
            text: '2020年收入报表',
            subtext: '2020年',
            x:'center'
        },
        tooltip : {
            trigger: 'axis',
        },
        legend: {
            orient: 'vertical',
            left: 'left',
        },
        grid:{
            left: '3%',
            right: '4%',
            bottom: '30%',
            containLabel: true
        },
        toolbox: {
            show: true,
            feature: {
                dataView: {readOnly: false},
                restore: {},
                saveAsImage: {}
            }
        },
        xAxis: {
            type: 'category',
            // boundaryGap: true,
            name: '日期',
            data: xData
        },
        yAxis: {
            name: '钱',
            type: 'value'
        },
        series : [
            {
                name: '收入',
                type: 'line',
                stack: '总量',
                // smooth: true,
                data: yData,

            }]
    };

    myChart.setOption(option);



</script>
</body>
</html>
